<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- 1. Skenario Dampak Kegagalan ITGC (FAQ 4) -->
        <record id="demo_app_legacy_failed" model="icofr.application">
            <field name="name">Sistem Warisan (Legacy ERP v1)</field>
            <field name="code">APP-LEGACY-001</field>
            <field name="description">Sistem lama yang masih digunakan untuk modul hutang. Memiliki kelemahan ITGC pada area manajemen perubahan.</field>
            <field name="itgc_effectiveness">ineffective</field>
            <field name="last_itgc_assessment_date" eval="time.strftime('%Y-01-15')"/>
            <field name="status">active</field>
        </record>

        <record id="demo_ctrl_auto_failed" model="icofr.control">
            <field name="name">Matching Otomatis PO vs Invoice (Legacy)</field>
            <field name="code">CTRL-AUTO-LEGACY-001</field>
            <field name="control_type">preventive</field>
            <field name="control_type_detailed">automated</field>
            <field name="application_id" ref="demo_app_legacy_failed"/>
            <field name="description">Kontrol otomatis untuk mencocokkan PO dan Invoice sebelum pembayaran.</field>
            <field name="frequency">per_transaction</field>
            <field name="owner_id" ref="icofr_demo.demo_user_finance_manager"/>
            <field name="status">active</field>
            <field name="notes">PERHATIAN: Kontrol ini memiliki 'is_itgc_reliance_failed' = True karena ITGC aplikasi pendukungnya Tidak Efektif.</field>
        </record>

        <!-- 2. Skenario EUC Kompleksitas Tinggi (Tabel 14) -->
        <record id="demo_ctrl_euc_high" model="icofr.control">
            <field name="name">Spreadsheet Valuasi Cadangan Klaim (EUC High)</field>
            <field name="code">CTRL-EUC-HIGH-001</field>
            <field name="control_type">detective</field>
            <field name="control_specific_type">euc</field>
            <field name="euc_complexity">high</field>
            <field name="description">Spreadsheet kompleks untuk menghitung estimasi cadangan klaim dengan model aktuaria.</field>
            <!-- 5 Mandatory Criteria for High Complexity (Table 14) -->
            <field name="euc_has_access_ctrl" eval="True"/>
            <field name="euc_has_integrity_ctrl" eval="True"/>
            <field name="euc_has_backup_ctrl" eval="True"/>
            <field name="euc_has_documentation" eval="True"/>
            <field name="euc_has_review_approval" eval="True"/>
            
            <field name="frequency">monthly</field>
            <field name="owner_id" ref="icofr_demo.demo_user_finance_manager"/>
            <field name="status">active</field>
        </record>

        <!-- 3. Skenario Mandatory December Sample (Tabel 22) -->
        <record id="demo_test_december_ok" model="icofr.testing">
            <field name="name">Uji Efektivitas Bulanan - Desember 2024</field>
            <field name="control_id" ref="icofr_demo.demo_ctrl_cash_001"/>
            <field name="test_type">toe</field>
            <field name="control_frequency">monthly</field>
            <field name="tester_id" ref="icofr_demo.demo_user_jane_smith"/>
            <field name="test_date" eval="time.strftime('%Y-12-20')"/>
            <field name="has_december_sample" eval="True"/>
            <field name="status">completed</field>
            <field name="effectiveness">effective</field>
            <field name="test_results">Sampel mencakup transaksi minggu ke-2 Desember. Seluruhnya patuh.</field>
        </record>

        <!-- 4. Skenario Kepatuhan Cooling-off (Hal 19) -->
        <!-- User baru untuk demonstrasi kepatuhan auditor -->
        <record id="demo_user_auditor_clean" model="res.users">
            <field name="name">Auditor Baru (Rina)</field>
            <field name="login">rina_auditor</field>
            <field name="password">Rina123</field>
            <field name="email">rina@demo.com</field>
        </record>

        <record id="icofr.group_icofr_line_3" model="res.groups">
            <field name="user_ids" eval="[(4, ref('demo_user_auditor_clean'))]"/>
        </record>

        <record id="demo_test_cooling_off_valid" model="icofr.testing">
            <field name="name">Uji Audit - Bebas Konflik Kepentingan</field>
            <field name="control_id" ref="icofr_demo.demo_ctrl_payroll_001"/>
            <field name="test_type">toe</field>
            <field name="tester_id" ref="demo_user_auditor_clean"/>
            <field name="test_date" eval="time.strftime('%Y-05-10')"/>
            <field name="status">completed</field>
            <field name="effectiveness">effective</field>
            <field name="notes">Auditor Rina tidak memiliki riwayat keterlibatan dengan kontrol ini dalam 12 bulan terakhir.</field>
        </record>

        <!-- 5. Skenario Log Perubahan Kontrol (Lampiran 6) -->
        <record id="demo_log_change_001" model="icofr.change.log">
            <field name="process_id" ref="icofr_demo.demo_proc_cashin_001"/>
            <field name="control_id" ref="icofr_demo.demo_ctrl_cash_001"/>
            <field name="date_report" eval="time.strftime('%Y-02-15')"/>
            <field name="date_effective" eval="time.strftime('%Y-03-01')"/>
            <field name="control_owner_id" ref="icofr_demo.demo_user_finance_manager"/>
            <field name="description_before">Otorisasi transaksi hanya dilakukan secara manual untuk nilai di atas Rp 10.000.000.</field>
            <field name="description_after">Otorisasi transaksi menggunakan tanda tangan digital (e-sign) melalui sistem ERP untuk nilai di atas Rp 10.000.000 guna meningkatkan audit trail.</field>
            <field name="ref_before">SOP-CASH-2023-V1</field>
            <field name="ref_after">SOP-CASH-2024-V2</field>
            <field name="state">approved</field>
            <field name="approved_by" ref="icofr_demo.demo_user_finance_manager"/>
            <field name="known_by" ref="icofr_demo.demo_user_risk_manager"/>
        </record>

    </data>
</odoo>
